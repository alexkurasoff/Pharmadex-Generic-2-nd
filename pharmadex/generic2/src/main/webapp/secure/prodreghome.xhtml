<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                template="../templates/admin_layout.xhtml">
    <ui:define name="content">
        <div class="post">
            <h1 class="title ui-widget-header ui-corner-all"> 
            	<p:outputLabel value="#{msgs.product_reg}" rendered="#{!userSession.admin}"/>
            	<p:outputLabel value="#{msgs.header_edit_app}" rendered="#{userSession.admin}"/>
            </h1>
        </div>

        <h:form id="reghome" enctype="multipart/form-data">
            <p:growl id="growl" showSummary="true" autoUpdate="true"/>
            <p:messages showSummary="true" showDetail="false" id="messages"/>
            <pe:ajaxErrorHandler/>
            <p:wizard widgetVar="wizard" id="wizardPnl" showNavBar="true"
                      flowListener="#{prodRegAppMbeanMZ.onFlowProcess}" 
                      onback="if(confirm('#{msgs.backDlg_war}') == true){return true;}else{return false;}" >

                <pe:ajaxErrorHandler/>

                <p:tab id="prodreg" title="#{msgs.applicant_detail}">
					<ui:decorate template="appinfosub.xhtml">
	                	<ui:param name="regHomeData" value="#{prodRegAppMbean}"/>
	                	<ui:param name="appSelectData" value="#{appSelectMBean}"/>
	                	<ui:param name="displayLH" value="#{userSession.ethiopia}"/>
	                </ui:decorate>

                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="proddetails" title="#{msgs.product_details}">
                    <p:panel header="#{msgs.product_details}">
						<ui:include src="proddetails.xhtml"/>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="appdetails" title="#{msgs.application_detail}">
                    <p:panel header="#{msgs.application_detail}" id="appDetailPnl">
                        <h:panelGrid id="adddetailgrid" columns="2" cellspacing="10px" cellpadding="10px" 
    				 				columnClasses="label, value" styleClass="grid" style="width:100%;">
                            <p:outputLabel value="#{msgs.new_chemical_name}*" styleClass="label"
                                           rendered="#{prodRegAppMbean.product.newChemicalEntity}"/>
                            <p:inputText id="nceInput" value="#{prodRegAppMbean.product.newChemicalName}"
                                         style="width:100%;"  
                                         required="true" requiredMessage="#{msgs.newChemName_missing}"                                         
                                         rendered="#{prodRegAppMbean.product.newChemicalEntity}"/>

                            <h:outputLabel value="#{msgs.active_substance}" style="width: 60px;" styleClass="label"/>
                            
                            <p:dataTable id="inntable" var="prodInn" value="#{prodRegAppMbean.selectedInns}"
                                         style="width:100%;" editable="true"
                                         emptyMessage="No INNs selected">
                                <f:facet name="header">
                                    <p:commandLink value="#{msgs.global_add}*" action="#{prodAddDetailMBean.openAddInn}"
                                                   id="addInnBtn"
                                                   oncomplete="PF('addInnDlg').show()" update=":addInnFrm"/>
                                </f:facet>

                                <p:ajax event="rowEdit" listener="#{prodAddDetailMBean.onRowEdit}"
                                        update=":reghome:messages :reghome:growl"/>
                                <p:ajax event="rowEditCancel" listener="#{prodAddDetailMBean.onRowCancel}"
                                        update=":reghome:messages"/>

                                <p:column headerText="#{msgs.product_innname}">
                                    <h:outputText value="#{prodInn.inn.name}"/>
                                </p:column>

                                <p:column headerText="#{msgs.dos_strength}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{prodInn.dosStrength}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputText value="#{prodInn.dosStrength}" style="width:100%"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="#{msgs.dos_unit}">
                                    <h:outputText value="#{prodInn.dosUnit.uom}"/>
                                </p:column>

                                <p:column headerText="#{msgs.inn_ref}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{prodInn.refStd}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputText value="#{prodInn.refStd}" style="width:100%"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

								<p:column headerText="#{msgs.manuf_name}">
                                    <h:outputText value="#{prodInn.company.companyName}"/>
                                </p:column>
                                
                                <p:column style="width:32px">
                                    <p:rowEditor/>
                                </p:column>

                                <p:column style="width:32px">
                                    <p:commandLink action="#{prodRegAppMbean.removeInn(prodInn)}"
                                                   styleClass="ui-icon ui-icon-trash"
                                                   update=":reghome:atctable :reghome:inntable :reghome:growl"
                                                   immediate="true">
                                    </p:commandLink>
                                </p:column>

                            </p:dataTable>

                            <h:outputLabel value="#{msgs.product_active}" style="width: 60px;" styleClass="label"/>
                            <p:dataTable id="expnttable" var="prodExp" value="#{prodRegAppMbean.selectedExipients}"
                                         style="width:100%;" editable="true"
                                         emptyMessage="#{msgs.prod_expnt_not_selected}"
                                    >
                                <f:facet name="header">
                                    <p:commandLink value="#{msgs.global_add}" action="#{prodAddDetailMBean.openAddExp}"
                                                   id="addExpBtn"
                                                   oncomplete="PF('addExpntDlg').show()" update=":addExpFrm"/>
                                </f:facet>

                                <p:ajax event="rowEdit" listener="#{prodAddDetailMBean.onRowEdit}"
                                        update=":reghome:messages :reghome:growl"/>
                                <p:ajax event="rowEditCancel" listener="#{prodAddDetailMBean.onRowCancel}"
                                        update=":reghome:messages"/>

                                <p:column headerText="#{msgs.excipient_name}">
                                    <h:outputText value="#{prodExp.excipient.name}"/>
                                </p:column>

                                <p:column headerText="#{msgs.dos_strength}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{prodExp.dosStrength}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputText value="#{prodExp.dosStrength}" style="width:100%"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="#{msgs.dos_unit}">
                                    <h:outputText value="#{prodExp.dosUnit.uom}"/>
                                </p:column>

                                <p:column headerText="#{msgs.inn_funct}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{prodExp.function}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputText value="#{prodExp.function}" style="width:100%"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="#{msgs.inn_ref}">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{prodExp.refStd}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputText value="#{prodExp.refStd}" style="width:100%"/>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>


                                <p:column style="width:32px">
                                    <p:rowEditor/>
                                </p:column>

                                <p:column style="width:32px">
                                    <p:commandLink action="#{prodRegAppMbean.removeExcipient(prodExp)}"
                                                   styleClass="ui-icon ui-icon-trash"
                                                   update=":reghome:expnttable :reghome:growl" immediate="true">
                                    </p:commandLink>
                                </p:column>
                            </p:dataTable>

                            <h:outputLabel value="#{msgs.atc_header}" style="width: 60px;" styleClass="label"/>


                            <h:panelGrid columns="3" cellspacing="10">
                                <h:outputLabel value="#{msgs.atc_noatc}: " for="noatc"/>
                                <p:selectBooleanCheckbox id="noatc"
                                                         value="#{prodRegAppMbean.product.noAtc}"> </p:selectBooleanCheckbox>
                                <p:commandLink id="atcLookUpBtn" value="#{msgs.atc_lookup}"
                                               oncomplete="PF('addAtcDlg').show()"
                                               action="#{prodAddDetailMBean.openAddATC}"/>
                            </h:panelGrid>
                            <h:outputLabel/>

                            <p:dataTable id="atctable" var="atc" value="#{prodRegAppMbean.selectedAtcs}"
                                         style="width:100%;">
                                <p:column headerText="#{msgs.atc_code}">
                                    <h:outputText value="#{atc.atcCode}"/>
                                </p:column>

                                <p:column headerText="#{msgs.atc_name}">
                                    <h:outputText value="#{atc.atcName}"/>
                                </p:column>

                                <p:column>
                                    <p:commandButton action="#{prodRegAppMbean.removeAtc(atc)}"
                                                     value="#{msgs.global_delete}"
                                                     update=":reghome:atctable :reghome:inntable :reghome:growl"
                                                     immediate="true">
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>

                        </h:panelGrid>

                        <ui:include src="prodadddetails.xhtml"/>
                        
                        <p:blockUI block="appDetailPnl"
                                   trigger=":reghome:inntable:addInnBtn :reghome:atcLookUpBtn :reghome:expnttable:addExpBtn">
                            <p:graphicImage name="/resources/images/ajax-loader.gif"/>
                        </p:blockUI>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="applicationStatus" title="#{msgs.appl_status_country}" rendered="#{prodRegAppMbeanMZ.visibleForeignTab}">
                    <p:panel header="#{msgs.appl_status_country}" id="statusPnl">
                        <p:messages/>
                        <h:panelGrid columns="1" cellspacing="10" id="foreignstatusgrid" width="100%">

                            <p:outputLabel styleClass="hint" value="#{msgs.foreign_cntry_hint}"/>
                            <p:outputLabel value="#{msgs.foreign_country_status_txt}" styleClass="label"/>


                            <p:dataTable id="foreignStatusTable" var="appstatus"
                                         value="#{prodRegAppMbean.foreignAppStatuses}"
                                         style="width:100%;">
                                <f:facet name="header">
                                    <p:commandLink id="addStatusBtn" value="#{msgs.global_add}"
                                                   oncomplete="PF('addForeignStatusDlg').show()"
                                                   action="#{foreignAppStatusMBean.initAddCompany}"
                                                   update=":addForeignStatus"
                                            >
                                    </p:commandLink>
                                </f:facet>
                                <p:column headerText="#{msgs.applicant_country}">
                                    <h:outputText value="#{appstatus.country.countryName}"/>
                                </p:column>

                                <p:column headerText="#{msgs.foreign_country_status_type}">
                                    <h:outputText value="#{msgs[appstatus.foreignAppStatusType.key]}"/>
                                </p:column>

                                <p:column headerText="#{msgs.prod_name}">
                                    <h:outputText value="#{appstatus.prodName}"/>
                                </p:column>

                                <p:column headerText="#{msgs.mkt_auth_holder}">
                                    <h:outputText value="#{appstatus.mktAuthHolder}"/>
                                </p:column>

                                <p:column headerText="#{msgs.mkt_auth_cert}">
                                    <h:outputText value="#{appstatus.mktAuthCert}"/>
                                </p:column>

                                <p:column headerText="#{msgs.mkt_auth_date}">
                                    <h:outputText value="#{appstatus.mktAuthDate}">
                                        <f:convertDateTime pattern="MMM dd, yyyy"/>
                                    </h:outputText>
                                </p:column>

                                <p:column>
                                    <p:commandButton action="#{prodRegAppMbean.removeAppStatus(appstatus)}"
                                                     value="#{msgs.global_delete}"
                                                     update=":addForeignStatus :reghome:foreignStatusTable :reghome:growl"
                                                     immediate="true"
                                            >
                                    </p:commandButton>
                                </p:column>

                            </p:dataTable>

                        </h:panelGrid>

						<p:blockUI block="statusPnl" trigger=":reghome:foreignStatusTable:addStatusBtn">
                            <p:graphicImage name="/resources/images/ajax-loader.gif"/>
                        </p:blockUI>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="manufdetail" title="#{msgs.manufacturer_detail}">
                    <p:panel header="#{msgs.manufacturer_detail}" id="manufPnl">
                        <p:messages/>
                        <h:panelGrid columns="1" cellspacing="10" id="companygrid" width="100%">
                            <p:outputLabel value="#{msgs.manuf_detail_txt}" styleClass="hint"/>

                            <p:dataTable id="companyTable" var="company" value="#{prodRegAppMbeanNA.prodCompanies}"
                                         style="width:100%;">
                                <f:facet name="header">
                                    <p:commandLink id="addManufBtn" value="#{msgs.global_add}*"
                                                   oncomplete="PF('addCompanyDlg').show()"
                                                   action="#{companyMBean.initAddCompany}" update=":addcompany"
                                                   process="@form :addcompany">
                                    </p:commandLink>
                                </f:facet>
                                <p:column headerText="#{msgs.manuf_name}">
                                    <h:outputText value="#{company.company.companyName}"/>
                                </p:column>

                                <p:column headerText="#{msgs.applicant_country}">
                                    <h:outputText value="#{company.company.address.country.countryName}"/>
                                </p:column>

                                <p:column headerText="#{msgs.manuf_type}">
                                    <h:outputText value="#{msgs[company.companyType.key]}"/>
                                </p:column>

                                <p:column headerText="#{msgs.applicant_phone}">
                                    <h:outputText value="#{company.company.phoneNo}"/>
                                </p:column>

                                <p:column>
                                    <p:commandButton action="#{prodRegAppMbean.removeCompany(company)}"
                                                     value="#{msgs.global_delete}"
                                                     update=":addcompany :reghome:companyTable :reghome:growl"
                                                     immediate="true" rendered="#{prodRegAppMbeanNA.visBtnDelete(company)}">
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>

                        </h:panelGrid>

						<p:blockUI block="manufPnl" trigger=":reghome:companyTable:addManufBtn">
                            <p:graphicImage name="/resources/images/ajax-loader.gif"/>
                        </p:blockUI>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="pricing" title="#{msgs.product_pricing}" rendered="#{userSession.displayPricing}">
                    <p:panel header="#{msgs.product_pricing_general}" id="pricingPnl">
                        <p:messages/>

                        <h:panelGrid columns="3" cellpadding="10px" cellspacing="10px" columnClasses="col1, col2, col3">
                            <p:outputLabel value="#{msgs.product_pricing_max}" for="msrp"/>
                            <p:inputText id="msrp" value="#{prodRegAppMbean.pricing.msrp}"
                                         title="#{msgs.product_pricing_max}"
                                         style="width: 350px;"/>
                            <p:outputLabel value="#{msgs.product_packsize}: #{prodRegAppMbean.product.packSize}" 
                            				style = "text-align: left;"/>

                            <p:outputLabel value="#{msgs.product_pricing_perdose}" for="priceperdose"/>
                            <p:inputText id="priceperdose" value="#{prodRegAppMbean.pricing.pricePerDose}"
                                         title="#{msgs.product_pricing_perdose}"
                                         style="width: 350px;"/>
                            <p:outputLabel />

                            <p:outputLabel value="#{msgs.product_pricing_perday}" for="priceperday"/>
                            <p:inputText id="priceperday" value="#{prodRegAppMbean.pricing.pricePerDay}"
                                         title="#{msgs.product_pricing_perdose}"
                                         style="width: 350px;"/>
                            <p:outputLabel />

                            <p:outputLabel value="#{msgs.product_pricing_treatcost}" for="treatcost"/>
                            <p:inputText id="treatcost" value="#{prodRegAppMbean.pricing.treatCost}"
                                         title="#{msgs.product_pricing_perdose}"
                                         style="width: 350px;"/>
                            <p:outputLabel />

                        </h:panelGrid>
                    </p:panel>

                    <p:panel header="#{msgs.product_price_comparison}" id="priceCompPnl">
                        <p:dataTable id="pricetable" var="price" value="#{prodRegAppMbean.drugPrices}"
                                     style="width:100%;">
                            <f:facet name="header">
                                <p:commandLink id="priceCompBtn" value="#{msgs.global_add}"
                                               oncomplete="PF('addPricingDlg').show()" update=":addpricing"
                                        >
                                    <f:setPropertyActionListener value="true"
                                                                 target="#{prodRegAppMbean.showDrugPrice}"/>
                                </p:commandLink>
                            </f:facet>
                            <p:column headerText="#{msgs.drug_price_name}">
                                <h:outputText value="#{price.drugName}"/>
                            </p:column>

                            <p:column headerText="#{msgs.drug_price_msrp}">
                                <h:outputText value="#{price.msrp}"/>
                            </p:column>

                            <p:column>
                                <p:commandButton action="#{prodRegAppMbean.removeDrugPrice(price)}"
                                                 value="#{msgs.global_delete}"
                                                 update=":addpricing :reghome:pricetable :reghome:growl"
                                                 immediate="true">
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
						
						<p:blockUI block="priceCompPnl" trigger=":reghome:pricetable:priceCompBtn">
                            <p:graphicImage name="/resources/images/ajax-loader.gif"/>
                        </p:blockUI>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="payment" title="#{msgs.screening_fee}">
                    <p:panel header="#{msgs.screening_fee}">
                      <!--<ui:decorate template="../templates/prescrpayment.xhtml">
                            <ui:param name="prodApp" value="#{prodRegAppMbean.prodApplications}"/>
                        </ui:decorate>-->
                        <ui:decorate template="/templates/amdpayment.xhtml">
							<ui:param name="payment" value="#{prodRegAppMbean.prodApplications.paymentPrescreen}" />
							<ui:param name="readonly" value="false" />
						</ui:decorate>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="attach" title="#{msgs.attachments}">
                    <p:panel>
                        <h:panelGrid columns="1" cellpadding="5" cellspacing="5">
                            <p:outputLabel value="#{msgs.reg_form_attach_hint}" styleClass="hint"/>

                            <p:outputLabel value="#{msgs.reg_form_attach_hint2}" styleClass="hint"/>

                            <p:commandButton icon="ui-icon-document" value="#{msgs.adddocument}"
                                             oncomplete="PF('attachDlg').show()"
                                             action="#{prodRegAppMbean.prepareUpload}"
                                             update=":attachfrm" id="addDocBtn"/>

                            <p:dataTable id="attachtable" value="#{prodRegAppMbean.attachments}" var="doc">

                                <p:column headerText="#{msgs.title}">
                                    <h:outputText value="#{doc.title}"/>
                                </p:column>

                                <p:column headerText="#{msgs.filename}">
                                    <h:outputText value="#{doc.fileName}"/>
                                </p:column>

                                <p:column headerText="#{msgs.uploaddate}">
                                    <h:outputText converter="javax.faces.DateTime" value="#{doc.createdDate}"/>
                                </p:column>

                                <p:column headerText="#{msgs.uploadedby}">
                                    <h:outputText value="#{doc.uploadedBy.name}"/>
                                </p:column>

                                <p:column headerText="#{msgs.registration_status}">
                                    <h:outputText value="#{msgs[doc.regState.key]}"/>
                                </p:column>

								<p:column>
                                    <p:commandButton id="downloadLink" value="#{msgs.global_download}" ajax="false"
                                                             onclick="PrimeFaces.monitorDownload(start, stop)"
                                                             icon="ui-icon-arrowthichk-s">
                                    	<p:fileDownload value="#{fileUploadController.fileDownload(doc)}"/>
                                    </p:commandButton>
                                </p:column>
                                
                                <p:column>
                                    <p:commandButton id="deleteattach"
                                                     action="#{prodRegAppMbean.deleteDoc(doc)}" ajax="false"
                                                     icon="ui-icon-trash"
                                                     update=":reghome:attachtab:attachtable"/>
                                </p:column>
                            </p:dataTable>
                        </h:panelGrid>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="prodAppChecklist" title="#{msgs.checklist}" rendered="#{prodRegAppMbeanMZ.visibleTabsByEdit}">
                    <p:panel header="#{msgs.checklist}">
                        <ui:decorate template="/templates/prodappchecklist.xhtml">
                            <ui:param name="prodAppChecklists" value="#{prodRegAppMbean.prodAppChecklists}"/>
                            <ui:param name="editable" value="true"/>
                        </ui:decorate>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

                <p:tab id="summary" title="Summary">
                    <p:panel header="Summary">
                    	<div align="right">
					        <p:commandButton icon="ui-icon-print" value="#{msgs.global_print}" type="button">
					            <p:printer target="prodsummaccpnl"/>
					        </p:commandButton>
					    </div>
                        <ui:decorate template="/templates/summerytabtmpl.xhtml">
                            <ui:param name="prodAppData" value="#{prodRegAppMbean.prodApplications}"/>
                            <ui:param name="foreignAppStatus" value="#{prodRegAppMbean.foreignAppStatuses}"/>
                            <ui:param name="prodAppChecklists" value="#{prodRegAppMbean.prodAppChecklists}"/>
                        </ui:decorate>
                    </p:panel>
                    <ui:include src="wizardnavigation.xhtml"/>
                </p:tab>

            </p:wizard>

            <p:ajaxExceptionHandler type="javax.faces.application.ViewExpiredException"
                                    update="exceptionDialog"
                                    onexception="PF('exceptionDialog').show();"/>

            <p:ajaxExceptionHandler type="java.lang.NullPointerException"
                                    update="exceptionDialog"
                                    onexception="PF('exceptionDialog').show();"/>
            <p:ajaxExceptionHandler type="java.lang.Exception"
                                    update="exceptionDialog"
                                    onexception="PF('exceptionDialog').show();"/>
            <p:dialog id="exceptionDialog" header="Exception occured!" widgetVar="exceptionDialog"
                      height="500px" dynamic="true">


                <p:button onclick="document.location.href = document.location.href;"
                          value="Reload!"
                        />
            </p:dialog>
        </h:form>

        <p:dialog header="#{msgs.add_active_substance}" widgetVar="addInnDlg" id="addInndlg" resizable="true"
                  modal="true" dynamic="true" width="900px">
            <h:form id="addInnFrm">
            	<ui:decorate template="/templates/prodInnDetail.xhtml">
					<ui:param name="prodInn" value="#{prodAddDetailMBean.prodInn}"/>
				    <ui:param name="edit" value="#{true}"/>
			    </ui:decorate>
                <p:commandButton action="#{prodAddDetailMBean.addProdInn}" value="#{msgs.global_add}"
                                 oncomplete="if(!args.validationFailed) PF('addInnDlg').hide()"
                                 update=":reghome:atctable :reghome:inntable :addInnFrm :reghome:growl"/>
                <p:commandButton action="#{prodAddDetailMBean.cancelAddInn}" immediate="true"
                                 value="#{msgs.global_cancel}" ajax="true"
                                 oncomplete="PF('addInnDlg').hide()" update=":addInnFrm"/>
            </h:form>
        </p:dialog>

        <p:dialog header="#{msgs.product_active}" widgetVar="addExpntDlg" id="addExpntdlg" resizable="true" modal="true"
                  dynamic="true">
            <h:form id="addExpFrm">
                <pe:ajaxErrorHandler/>
                <ui:decorate template="/templates/prodExcipientDetail.xhtml">
					<ui:param name="prodExc" value="#{prodAddDetailMBean.prodExcipient}"/>
				    <ui:param name="edit" value="#{true}"/>
			    </ui:decorate>
			    
               <p:commandButton action="#{prodAddDetailMBean.addProdExcipient}"
						value="#{msgs.global_add}"
						oncomplete="!if(args.validationFailed) addExpntDlg.hide()"
						update=":reghome:expnttable :addExpFrm :reghome:growl" />
				<p:commandButton action="#{prodAddDetailMBean.cancelAddExcipient}"
						immediate="true" value="#{msgs.global_cancel}" ajax="true"
						oncomplete="PF('addExpntDlg').hide()" update=":addExpFrm" />
            </h:form>
        </p:dialog>

        <p:dialog header="ATC Lookup" widgetVar="addAtcDlg" resizable="true" modal="true" dynamic="true">
            <h:form id="atcdetail">
                <h:panelGrid columns="2" cellspacing="5" columnClasses="label, value" styleClass="grid"
                             id="atclookupgrid">
                    <h:outputLabel value="#{msgs.atc_name}" for="atcname"/>
                    <p:autoComplete id="atcname" value="#{prodAddDetailMBean.atc}"
                                    completeMethod="#{globalEntityLists.completeAtcNames}"
                                    var="it" itemLabel="#{it.atcName}" itemValue="#{it}" converter="#{atcConverter}"
                                    forceSelection="true">
                        <p:ajax event="itemSelect" listener="#{prodAddDetailMBean.updateAtc}" update=":atcdetail"/>
                    </p:autoComplete>

                    <h:outputLabel value="#{msgs.atc_code}" for="atccode"/>
                    <p:outputLabel value="#{prodAddDetailMBean.atc.atcCode}" id="atccode"/>
                </h:panelGrid>


                <p:tree value="#{prodAddDetailMBean.selAtcTree}" var="node" id="treeMultiple" selectionMode="single">
                    <p:treeNode>
                        <h:outputText value="#{node}"/>
                    </p:treeNode>
                </p:tree>


                <h:outputLabel/>

                <h:panelGroup>
                    <p:commandButton action="#{prodAddDetailMBean.addAtc}" value="#{msgs.global_add}"
                                     update=":reghome:atctable :atcdetail :atcdetail:treeMultiple"
                                     oncomplete="PF('addAtcDlg').hide()"/>
                    <p:commandButton action="#{prodAddDetailMBean.cancelAddInn}" value="#{msgs.global_cancel}"
                                     oncomplete="PF('addAtcDlg').hide()"/>
                </h:panelGroup>
                <h:outputLabel/>

            </h:form>
        </p:dialog>

        <p:dialog header="#{msgs.company_info}" widgetVar="addCompanyDlg" id="addCompanydlg" resizable="true"
                  modal="true" dynamic="true" width="800px">
            <h:form id="addcompany">
                <ui:decorate template="/templates/companydetailtmpl.xhtml">
                    <ui:param name="companydata" value="#{companyMBean.selectedCompany}"/>
                    <ui:param name="showCompType" value="#{true}"/>
                </ui:decorate>

                <h:outputLabel/>

                <h:panelGroup>
                    <p:commandButton action="#{companyMBean.addCompany}" value="#{msgs.global_add}"
                                     oncomplete="if (!args.validationFailed) PF('addCompanyDlg').hide()" process="@form"
                                     update="@form :reghome:companygrid :reghome:companyTable :reghome:growl"/>
                    <p:commandButton action="#{companyMBean.cancelAdd}" immediate="true" value="#{msgs.global_cancel}"
                                     oncomplete="PF('addCompanyDlg').hide()" ajax="false" process="@form"
                                     update=":addcompany :reghome:companyTable"/>
                </h:panelGroup>
                <h:outputLabel/>
            </h:form>
        </p:dialog>

        <p:dialog header="#{msgs.foreign_country_status_txt}" widgetVar="addForeignStatusDlg" id="addForeignStatusdlg"
                  dynamic="true"
                  resizable="true" modal="true">
            <h:form id="addForeignStatus">
                <p:messages showSummary="true"/>

                <h:panelGrid id="foreignstatustable" columns="2" columnClasses="label value">
                    <p:outputLabel value="#{msgs.foreign_country_status_type}" for="forStatuscb"
                                   styleClass="fy-required-field"/>
                    <p:selectOneMenu id="forStatuscb"
                                     value="#{foreignAppStatusMBean.selForeignAppStatus.foreignAppStatusType}"
                                     required="true">
                        <f:selectItem itemLabel="-" itemValue=""/>
                        <f:selectItems value="#{globalLists.foreignAppStatusType}" var="prodcat"
                                       itemLabel="#{msgs[prodcat.key]}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="#{msgs.applicant_country}" for="statusCntry"/>
                    <p:selectOneMenu value="#{foreignAppStatusMBean.selForeignAppStatus.country.id}" required="true"
                                     id="statusCntry">
                        <f:selectItem itemLabel="-" itemValue=""/>
                        <f:selectItems value="#{globalEntityLists.countries}" var="cntry"
                                       itemLabel="#{cntry.countryName}"
                                       itemValue="#{cntry.id}"/>
                    </p:selectOneMenu>

                    <p:outputLabel for="otherprodname" value="#{msgs.prod_name}"/>
                    <p:inputText value="#{foreignAppStatusMBean.selForeignAppStatus.prodName}" required="true"
                                 id="otherprodname"/>

                    <p:outputLabel for="mktauthholder" value="#{msgs.mkt_auth_holder}"/>
                    <p:inputText value="#{foreignAppStatusMBean.selForeignAppStatus.mktAuthHolder}" required="true"
                                 id="mktauthholder"/>

                    <p:outputLabel for="mktauthcert" value="#{msgs.mkt_auth_cert}"/>
                    <p:inputText value="#{foreignAppStatusMBean.selForeignAppStatus.mktAuthCert}" id="mktauthcert"/>

                    <h:outputLabel for="mktauthdate" value="#{msgs.mkt_auth_date}"/>
                    <p:calendar value="#{foreignAppStatusMBean.selForeignAppStatus.mktAuthDate}" id="mktauthdate" 
                    			navigator="true" showOn="button" rendered="true"
                                pattern="#{userAccessMBean.workspace.datePattern}">
                       <f:validator validatorId="pastDateValidator"/>
                    </p:calendar>
                </h:panelGrid>

                <h:panelGroup>
                    <p:commandButton action="#{foreignAppStatusMBean.addForStatus()}" value="#{msgs.global_add}"
                                     oncomplete="if (!args.validationFailed) PF('addForeignStatusDlg').hide()"
                                     ajax="true"
                                     update=":reghome:foreignstatusgrid :addForeignStatus" process="@form"/>
                    <p:commandButton action="#{companyMBean.cancelAdd}" immediate="true" value="#{msgs.global_cancel}"
                                     oncomplete="PF('addForeignStatusDlg').hide()" ajax="true" process="@form"
                                     update=":reghome:foreignstatusgrid :addForeignStatus"/>
                </h:panelGroup>
                <h:outputLabel/>
            </h:form>
        </p:dialog>

        <p:dialog header="#{msgs.product_pricing_comparison}" widgetVar="addPricingDlg" id="addPricingdlg"
                  resizable="true" dynamic="true"
                  modal="true">
            <h:form id="addpricing">
                <h:panelGrid columns="3" columnClasses="label value" cellpadding="10" cellspacing="10">
                    <h:outputLabel value="#{msgs.drug_price_name}" for="dpname"/>
                    <p:inputText id="dpname" value="#{drugPriceMBean.selectedDrugPrice.drugName}"
                                 title="#{msgs.product_pricing_perdose}"
                                 requiredMessage="#{msgs.valid_value_req}">
                    </p:inputText>
                    <p:message for="dpname" showSummary="true" showDetail="false"/>

                    <h:outputLabel value="#{msgs.drug_price_msrp}" for="dpmsrp"/>
                    <p:inputText id="dpmsrp" value="#{drugPriceMBean.selectedDrugPrice.msrp}"
                                 title="#{msgs.product_pricing_max}"
                                 required="true" requiredMessage="#{msgs.valid_value_req}">
                    </p:inputText>
                    <p:message for="dpmsrp" showSummary="true" showDetail="false"/>
                </h:panelGrid>


                <h:panelGroup>
                    <p:commandButton action="#{drugPriceMBean.addDrugPrice}" value="#{msgs.global_add}"
                                     oncomplete="if (!args.validationFailed) PF('addPricingDlg').hide()"
                                     update=":reghome:pricetable :reghome:growl :addpricing"/>
                    <p:commandButton action="#{drugPriceMBean.cancelAdd}" immediate="true" value="#{msgs.global_cancel}"
                                     oncomplete="PF('addPricingDlg').hide()" ajax="false"
                                     update=":addpricing :reghome:pricingTable"/>
                </h:panelGroup>
                <h:outputLabel/>
            </h:form>
        </p:dialog>

        <p:dialog header="#{msgs.adddocument}" widgetVar="attachDlg" resizable="false"
                  dynamic="true">
            <h:form id="attachfrm">
                <h:panelGrid columns="2" style="margin-bottom:10px">
                    <p:outputLabel value="#{msgs.title}"/>
                    <p:inputText value="#{prodRegAppMbean.attachment.title}"/>
                    <p:outputLabel value="#{msgs.global_comment}"/>
                    <p:inputTextarea value="#{prodRegAppMbean.attachment.comment}"
                                     rows="5" cols="50"/>
                </h:panelGrid>

                <p:fileUpload fileUploadListener="#{prodRegAppMbean.handleFileUpload}"
                              mode="advanced" process=":attachfrm" auto="true"
                              update=":reghome:growl :reghome:messages"
                              multiple="false"
                              sizeLimit="10000000000000">

                </p:fileUpload>

                <p:commandButton id="adddoc" value="#{msgs.global_submit}"
                                 action="#{prodRegAppMbean.addDocument}" process=":attachfrm"
                                 oncomplete="PF('attachDlg').hide()"
                                 update=":reghome:growl :reghome:messages :reghome :attachfrm"/>
            </h:form>
        </p:dialog>

    	<p:dialog modal="true" widgetVar="statusDialog" draggable="false" closable="false" 
        			resizable="false" dynamic="true" showHeader="false">
		    <p:graphicImage value="/resources/images/ajax-loader.gif" />
		</p:dialog>
	    <script type="text/javascript">
	        function start() {
	            PF('statusDialog').show();
	            setTimeout(function() {
					PF('statusDialog').hide();
				}, 3000);
	        }
	
	        function stop() {
	            PF('statusDialog').hide();
	        }
	
	        function expandAccPnl(){
	            $('#accordian').find('a[tabIndex=-1]:first').click();
	        }
	    </script>
    </ui:define>
</ui:composition>
